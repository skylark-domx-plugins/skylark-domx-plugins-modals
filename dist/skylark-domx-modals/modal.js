/**
 * skylark-domx-modals - The skylark dom api extenstion library for color
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx/skylark-domx-modals/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./modals"],function(t,e,i,s,o,n,a,r){"use strict";var d=a.Plugin.inherit({klassName:"Modal",pluginName:"lark.modals.modal",options:{backdrop:!0,keyboard:!0,show:!0},_construct:function(e,i){a.Plugin.prototype._construct.call(this,e,i),this.$container=n(i.container||document.body),this.$element=n(e),this.$dialog=this.$element.find(".modal-dialog"),this.$container.is("body")||this.$element.css("position","absolute"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.modal")},this)),this.show&&this.show()},toggle:function(t){return this.isShown?this.hide():this.show(t)},show:function(o){var a=this,r=i.create("show.modal",{relatedTarget:o});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$container.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.modal",function(){a.$element.one("mouseup.dismiss.modal",function(t){n(t.target).is(a.$element)&&(a.ignoreBackdropClick=!0)})}),this.backdrop(function(){var t=e.support.transition&&a.$element.hasClass("fade");s.isChildOf(a.$element[0],a.$container[0])||a.$element.appendTo(a.$container),a.$element.show().scrollTop(0),a.adjustDialog(),t&&a.$element[0].offsetWidth,a.$element.addClass("in"),a.enforceFocus();var n=i.create("shown.modal",{relatedTarget:o});t?a.$dialog.one("transitionEnd",function(){a.$element.trigger("focus").trigger(n)}).emulateTransitionEnd(d.TRANSITION_DURATION):a.$element.trigger("focus").trigger(n)}))},hide:function(s){s&&s.preventDefault(),s=i.create("hide.modal"),this.$element.trigger(s),this.isShown&&!s.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.modal"),this.$element.removeClass("in").off("click.dismiss.modal").off("mouseup.dismiss.modal"),this.$dialog.off("mousedown.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("transitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(d.TRANSITION_DURATION):this.hideModal())},enforceFocus:function(){n(document).off("focusin.modal").on("focusin.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},escape:function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.modal")},resize:function(){this.isShown?n(window).on("resize.modal",t.proxy(this.handleUpdate,this)):n(window).off("resize.modal")},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$container.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.modal")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(i){var s=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=e.support.transition&&o;if(this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$container),this.$container.is("body")||this.$backdrop.css("position","absolute"),this.$element.on("click.dismiss.modal",t.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;a?this.$backdrop.one("transitionEnd",i).emulateTransitionEnd(d.BACKDROP_TRANSITION_DURATION):i()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){s.removeBackdrop(),i&&i()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("transitionEnd",r).emulateTransitionEnd(d.BACKDROP_TRANSITION_DURATION):r()}else i&&i()},handleUpdate:function(){this.adjustDialog()},adjustDialog:function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},resetAdjustments:function(){this.$element.css({paddingLeft:"",paddingRight:""})},checkScrollbar:function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},setScrollbar:function(){var t=parseInt(this.$container.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$container.css("padding-right",t+this.scrollbarWidth)},resetScrollbar:function(){this.$container.css("padding-right",this.originalBodyPad)},measureScrollbar:function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$container.append(t);var e=t.offsetWidth-t.clientWidth;return this.$container[0].removeChild(t),e}});return d.TRANSITION_DURATION=300,d.BACKDROP_TRANSITION_DURATION=150,a.register(d),r.Modal=d});
//# sourceMappingURL=sourcemaps/modal.js.map
